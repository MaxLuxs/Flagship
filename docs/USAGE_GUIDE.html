<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USAGE GUIDE - Flagship</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.7;
            color: #1a1a1a;
            background: #ffffff;
        }

        .header {
            background: #f7f7f7;
            border-bottom: 1px solid #e0e0e0;
            padding: 20px 0;
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 40px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo { width: 40px; height: 40px; }

        .header-title {
            font-size: 20px;
            font-weight: 600;
            color: #1a1a1a;
            text-decoration: none;
        }

        .header-title:hover { color: #00d687; }

        .back-link {
            margin-left: auto;
            color: #666;
            text-decoration: none;
            font-size: 14px;
        }

        .back-link:hover { color: #00d687; }

        .content {
            max-width: 900px;
            margin: 60px auto;
            padding: 0 40px;
        }

        h1 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1a1a1a;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        h2 {
            font-size: 32px;
            font-weight: 600;
            margin: 50px 0 20px;
            color: #1a1a1a;
        }

        h3 {
            font-size: 24px;
            font-weight: 600;
            margin: 40px 0 16px;
            color: #1a1a1a;
        }

        h4 {
            font-size: 18px;
            font-weight: 600;
            margin: 30px 0 12px;
            color: #333;
        }

        p {
            margin: 16px 0;
            color: #333;
        }

        a {
            color: #00d687;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        code {
            background: #f7f7f7;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
            font-size: 14px;
            color: #ef7200;
        }

        pre {
            background: #f7f7f7;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: #1a1a1a;
            font-size: 14px;
            line-height: 1.6;
        }

        ul, ol {
            margin: 16px 0 16px 30px;
        }

        li {
            margin: 8px 0;
        }

        hr {
            border: none;
            border-top: 1px solid #e0e0e0;
            margin: 60px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            border: 1px solid #e0e0e0;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #f7f7f7;
            font-weight: 600;
        }

        blockquote {
            border-left: 3px solid #00d687;
            padding-left: 20px;
            margin: 20px 0;
            color: #666;
            font-style: italic;
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
        }

        footer {
            max-width: 900px;
            margin: 80px auto 40px;
            padding: 40px 40px 0;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        footer a {
            color: #00d687;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .content, .header-content, footer {
                padding-left: 20px;
                padding-right: 20px;
            }

            h1 { font-size: 32px; }
            h2 { font-size: 26px; }
            h3 { font-size: 20px; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <img src="images/flagship_icon.svg" alt="Flagship Logo" class="logo">
            <a href="index.html" class="header-title">Flagship</a>
            <a href="index.html" class="back-link">‚Üê Back to Documentation</a>
        </div>
    </header>
    <div class="content">
<p><p align="center"></p>
<p><img src="images/flagship_icon.svg" width="150" height="150" alt="Flagship Logo"></p>
<p></p></p>

<p><h1 align="center">üìñ Flagship Usage Guide</h1></p>

<p>Complete guide for using the Flagship library in your Android and iOS applications.</p>

<hr />

<h2>üìã Table of Contents</h2>

<p>1. <a href="#-quick-start">Quick Start</a></p>
<p>2. <a href="#-installation">Installation</a></p>
<p>3. <a href="#-initialization">Initialization</a></p>
<p>4. <a href="#-feature-flags">Feature Flags</a></p>
<p>5. <a href="#-ab-testing-experiments">A/B Testing (Experiments)</a></p>
<p>6. <a href="#-targeting-rules">Targeting Rules</a></p>
<p>7. <a href="#-providers">Providers</a></p>
<p>8. <a href="#-caching--offline-mode">Caching & Offline Mode</a></p>
<p>9. <a href="#-debug-dashboard">Debug Dashboard</a></p>
<p>10. <a href="#-analytics-integration">Analytics Integration</a></p>
<p>11. <a href="#-best-practices">Best Practices</a></p>
<p>12. <a href="#-faq">FAQ</a></p>

<hr />

<h2>üöÄ Quick Start</h2>

<h3>Android (Kotlin)</h3>

<pre><code class="language-kotlin">// 1. In Application class
class MyApp : Application() {
    override fun onCreate() {
        super.onCreate()
        
        // Recommended: Use factory for easy setup
        val config = FlagsConfig(
            appKey = &quot;my-banking-app&quot;,
            environment = &quot;production&quot;,
            providers = listOf(
                FirebaseProviderFactory.create(application)
            ),
            cache = PersistentCache(FlagsSerializer()),
            logger = DefaultLogger()
        )
        
        // Alternative: Manual setup (for advanced use cases)
        // val config = FlagsConfig(
        //     appKey = &quot;my-banking-app&quot;,
        //     environment = &quot;production&quot;,
        //     providers = listOf(
        //         FirebaseRemoteConfigProvider(AndroidFirebaseAdapter(Firebase.remoteConfig))
        //     ),
        //     cache = PersistentCache(FlagsSerializer()),
        //     logger = DefaultLogger()
        // )
        
        Flags.configure(config)
    }
}

// 2. In your app code
// Note: All flag access methods are suspend functions - use in coroutine scope
val flags = Flags.manager()

// Feature flag
lifecycleScope.launch {
    if (flags.isEnabled(&quot;new_payment_flow&quot;)) {
        NewPaymentScreen()
    } else {
        LegacyPaymentScreen()
    }
}

// A/B experiment
lifecycleScope.launch {
    val assignment = flags.assign(&quot;checkout_experiment&quot;)
    when (assignment?.variant) {
        &quot;control&quot; -&gt; OriginalCheckout()
        &quot;variant_a&quot; -&gt; NewCheckoutA()
        &quot;variant_b&quot; -&gt; NewCheckoutB()
    }
}
</code></pre>

<h3>iOS (Swift)</h3>

<pre><code class="language-swift">// 1. In AppDelegate or App.swift
import Flagship

@main
struct MyApp: App {
    init() {
        FlagshipIOSInitializer.shared.initialize()
    }
    
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}

// 2. In SwiftUI View
import Flagship

struct PaymentView: View {
    let flags = Flags.shared.manager()
    @State private var isNewPaymentEnabled = false
    
    var body: some View {
        if isNewPaymentEnabled {
            NewPaymentView()
        } else {
            LegacyPaymentView()
        }
        .onAppear {
            Task {
                isNewPaymentEnabled = await flags.isEnabled(key: &quot;new_payment_flow&quot;, default: false, ctx: nil)
            }
        }
    }
}
</code></pre>

<hr />

<h2>üì¶ Installation</h2>

<h3>Android</h3>

<h4>Step 1: Add Repository</h4>

<p>Add Maven repository to <code>settings.gradle.kts</code> (or <code>settings.gradle</code>):</p>

<pre><code class="language-kotlin">dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        // Add Flagship repository if published to custom Maven repo
        // maven { url = uri(&quot;https://jitpack.io&quot;) }
    }
}
</code></pre>

<h4>Step 2: Add Dependencies</h4>

<p>In your app module's <code>build.gradle.kts</code> (or <code>build.gradle</code>):</p>

<pre><code class="language-kotlin">dependencies {
    // Core library (includes Android platform support)
    implementation(&quot;io.maxluxs.flagship:flagship-core:0.1.0&quot;)
    
    // Providers (choose what you need)
    implementation(&quot;io.maxluxs.flagship:flagship-provider-rest:0.1.0&quot;)
    implementation(&quot;io.maxluxs.flagship:flagship-provider-firebase:0.1.0&quot;)
    // implementation(&quot;io.maxluxs.flagship:flagship-provider-launchdarkly:0.1.0&quot;)
    
    // Optional: Debug UI
    // implementation(&quot;io.maxluxs.flagship:flagship-ui-compose:0.1.0&quot;)
    
    // Required for REST provider
    implementation(&quot;io.ktor:ktor-client-android:3.3.2&quot;)
    implementation(&quot;io.ktor:ktor-client-content-negotiation:3.3.2&quot;)
    implementation(&quot;io.ktor:ktor-serialization-kotlinx-json:3.3.2&quot;)
    
    // Serialization
    implementation(&quot;org.jetbrains.kotlinx:kotlinx-serialization-json:1.9.0&quot;)
}
</code></pre>

<h4>Step 3: Enable Kotlin Serialization</h4>

<p>In your app's <code>build.gradle.kts</code>:</p>

<pre><code class="language-kotlin">plugins {
    id(&quot;com.android.application&quot;)
    kotlin(&quot;android&quot;)
    kotlin(&quot;plugin.serialization&quot;) // Add this
}
</code></pre>

<h4>Step 4: Initialize in Application Class</h4>

<p>Create or update your <code>Application</code> class:</p>

<pre><code class="language-kotlin">package com.example.myapp

import android.app.Application
import io.ktor.client.*
import io.ktor.client.engine.android.*
import io.ktor.client.plugins.contentnegotiation.*
import io.ktor.serialization.kotlinx.json.*
import io.maxluxs.flagship.core.Flags
import io.maxluxs.flagship.core.FlagsConfig
import io.maxluxs.flagship.core.manager.DefaultFlagsManager
import io.maxluxs.flagship.core.platform.AndroidFlagsInitializer
import io.maxluxs.flagship.provider.firebase.FirebaseProviderFactory
import io.maxluxs.flagship.provider.rest.RestFlagsProvider
import kotlinx.serialization.json.Json

class MyApplication : Application() {
    override fun onCreate() {
        super.onCreate()
        initializeFlagship()
    }
    
    private fun initializeFlagship() {
        // Create HTTP client for REST provider
        val httpClient = HttpClient(Android) {
            install(ContentNegotiation) {
                json(Json {
                    ignoreUnknownKeys = true
                    isLenient = true
                })
            }
        }
        
        // Configure providers (in priority order)
        val providers = listOf(
            // Option 1: Firebase Remote Config (recommended)
            FirebaseProviderFactory.create(
                application = this,
                defaults = mapOf(
                    &quot;new_feature&quot; to false,
                    &quot;max_retries&quot; to 3,
                    &quot;api_timeout&quot; to 30.0,
                    &quot;welcome_message&quot; to &quot;Welcome!&quot;
                ),
                name = &quot;firebase&quot;
            ),
            
            // Option 2: REST API (fallback)
            RestFlagsProvider(
                client = httpClient,
                baseUrl = &quot;https://api.example.com/flags&quot;
            )
        )
        
        // Create configuration
        val config = FlagsConfig(
            appKey = &quot;my-app&quot;, // Unique app identifier
            environment = if (BuildConfig.DEBUG) &quot;development&quot; else &quot;production&quot;,
            providers = providers,
            cache = AndroidFlagsInitializer.createPersistentCache(this),
            defaultRefreshIntervalMs = 15 * 60 * 1000L // 15 minutes
        )
        
        // Initialize Flagship
        Flags.configure(config)
        
        // Set default context
        val manager = Flags.manager() as DefaultFlagsManager
        val defaultContext = AndroidFlagsInitializer.createDefaultContext(this)
        manager.setDefaultContext(defaultContext)
    }
}
</code></pre>

<h4>Step 5: Register Application in AndroidManifest.xml</h4>

<pre><code class="language-xml">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
    &lt;application
        android:name=&quot;.MyApplication&quot;
        ...&gt;
        ...
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>

<h4>Step 6: Use in Your Code</h4>

<pre><code class="language-kotlin">import io.maxluxs.flagship.core.Flags

class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        
        val flags = Flags.manager()
        
        // Note: All flag access methods are suspend functions - use in coroutine scope
        lifecycleScope.launch {
            // Check boolean flag
            if (flags.isEnabled(&quot;new_payment_flow&quot;)) {
                showNewPaymentScreen()
            } else {
                showLegacyPaymentScreen()
            }
            
            // Get typed values
            val maxRetries = flags.value(&quot;max_retries&quot;, default = 3)
            val apiTimeout = flags.value(&quot;api_timeout&quot;, default = 30.0)
            val welcomeMessage = flags.value(&quot;welcome_message&quot;, default = &quot;Welcome!&quot;)
        }
    }
}
</code></pre>

<h4>Firebase Setup (Optional)</h4>

<p>If using Firebase Remote Config:</p>

<p>1. Add Firebase to your project following <a href="https://firebase.google.com/docs/android/setup">official documentation</a></p>
<p>2. Add <code>google-services.json</code> to <code>app/</code> directory</p>
<p>3. Add plugin to <code>build.gradle.kts</code>:</p>

<pre><code class="language-kotlin">plugins {
    id(&quot;com.google.gms.google-services&quot;)
}
</code></pre>

<p>4. FirebaseProviderFactory will handle initialization automatically</p>

<h3>iOS (Swift Package Manager)</h3>

<p>1. In Xcode: <strong>File > Add Packages...</strong></p>
<p>2. URL: <code>https://github.com/maxluxs/Flagship</code></p>
<p>3. Version: <code>0.1.0</code></p>
<p>4. Add Package</p>

<p>Or in <code>Package.swift</code>:</p>
<pre><code class="language-swift">dependencies: [
    .package(url: &quot;https://github.com/maxluxs/Flagship&quot;, from: &quot;0.1.0&quot;)
]
</code></pre>

<hr />

<h2>‚öôÔ∏è Initialization</h2>

<h3>Basic Configuration</h3>

<pre><code class="language-kotlin">val config = FlagsConfig(
    appKey = &quot;my-app&quot;,           // Unique app ID
    environment = &quot;production&quot;,   // production, staging, dev
    providers = listOf(/* ... */),
    cache = InMemoryCache(),     // or PersistentCache()
    logger = DefaultLogger()
)

Flags.configure(config)
</code></pre>

<h3>With Multiple Providers</h3>

<pre><code class="language-kotlin">// Using factories (recommended)
val config = FlagsConfig(
    appKey = &quot;my-app&quot;,
    environment = &quot;production&quot;,
    providers = listOf(
        FirebaseProviderFactory.create(application), // Priority 1
        RestFlagsProvider(httpClient, &quot;https://api.example.com/flags&quot;) // Fallback
    ),
    cache = PersistentCache(FlagsSerializer()),
    logger = DefaultLogger()
)
</code></pre>

<blockquote><strong>Note</strong>: <code>FirebaseProviderFactory</code> handles Firebase initialization automatically. For manual setup, see the <a href="#firebase-remote-config">Firebase Provider section</a>.</blockquote>

<p><strong>Important:</strong> Providers are processed in order. The first successful result is used.</p>

<h3>Async Loading</h3>

<pre><code class="language-kotlin">// In a coroutine
lifecycleScope.launch {
    val manager = Flags.manager()
    
    // Attempt to load data (with 5 second timeout)
    val success = manager.ensureBootstrap(timeoutMs = 5000)
    
    if (success) {
        // Data loaded, can use flags
    } else {
        // Using cache or default values
    }
}
</code></pre>

<hr />

<h2>üéØ Feature Flags</h2>

<h3>Simple Boolean Flag</h3>

<pre><code class="language-kotlin">val manager = Flags.manager()

if (manager.isEnabled(&quot;dark_mode&quot;)) {
    // Enable dark theme
}
</code></pre>

<h3>Typed Values</h3>

<pre><code class="language-kotlin">// String
val apiUrl: String = manager.value(&quot;api_base_url&quot;, default = &quot;https://api.example.com&quot;)

// Int
val timeout: Int = manager.value(&quot;request_timeout&quot;, default = 5000)

// Double
val discount: Double = manager.value(&quot;promo_discount&quot;, default = 0.1)

// JSON
val config: JsonObject = manager.value(&quot;feature_config&quot;, default = buildJsonObject {})
</code></pre>

<h3>Type Safety</h3>

<pre><code class="language-kotlin">// If type doesn&#39;t match, default value is returned
val value: String = manager.value(&quot;some_int_flag&quot;, default = &quot;fallback&quot;) // &quot;fallback&quot;
</code></pre>

<h3>Reactive Updates in Compose</h3>

<pre><code class="language-kotlin">@Composable
fun FeatureScreen() {
    val manager = Flags.manager()
    var featureEnabled by remember { mutableStateOf(manager.isEnabled(&quot;new_feature&quot;)) }
    
    // Listen for changes
    DisposableEffect(Unit) {
        val listener = object : FlagsListener {
            override fun onSnapshotUpdated(providersCount: Int) {
                featureEnabled = manager.isEnabled(&quot;new_feature&quot;)
            }
        }
        manager.addListener(listener)
        onDispose { manager.removeListener(listener) }
    }
    
    if (featureEnabled) {
        NewFeatureUI()
    } else {
        OldFeatureUI()
    }
}
</code></pre>

<hr />

<h2>üß™ A/B Testing (Experiments)</h2>

<h3>Basic Usage</h3>

<pre><code class="language-kotlin">val assignment = manager.assign(
    key = &quot;checkout_experiment&quot;,
    ctx = EvalContext(
        userId = &quot;user_12345&quot;,
        attributes = mapOf(&quot;tier&quot; to &quot;premium&quot;)
    )
)

when (assignment?.variant) {
    &quot;control&quot; -&gt; {
        // Original version (50%)
        OriginalCheckout()
    }
    &quot;variant_a&quot; -&gt; {
        // Variant A (25%)
        CheckoutVariantA()
    }
    &quot;variant_b&quot; -&gt; {
        // Variant B (25%)
        CheckoutVariantB()
    }
    else -&gt; {
        // Fallback (if experiment is disabled)
        OriginalCheckout()
    }
}
</code></pre>

<h3>With Payload Data</h3>

<pre><code class="language-kotlin">val assignment = manager.assign(&quot;button_color_test&quot;)

assignment?.let {
    val buttonColor = it.payload[&quot;color&quot;]?.jsonPrimitive?.content ?: &quot;#007AFF&quot;
    Button(
        colors = ButtonDefaults.buttonColors(
            containerColor = Color(parseColor(buttonColor))
        )
    ) { Text(&quot;Buy Now&quot;) }
}
</code></pre>

<h3>Deterministic Bucketing</h3>

<p>Flagship uses <strong>MurmurHash3</strong> for deterministic distribution:</p>
<ul>
<li>Same <code>userId</code> always falls into the same group</li>
<li>Uniform distribution (50/50, 33/33/34, etc.)</li>
<li>Cross-platform consistency (Android ‚Üî iOS)</li>
</ul>

<pre><code class="language-kotlin">// Same user always gets the same variant
val user1 = manager.assign(&quot;exp&quot;, EvalContext(userId = &quot;user_123&quot;))
val user2 = manager.assign(&quot;exp&quot;, EvalContext(userId = &quot;user_123&quot;))
// user1.variant == user2.variant ‚úÖ
</code></pre>

<h3>Exposure Tracking</h3>

<p>Flagship automatically sends exposure events for A/B tests:</p>

<pre><code class="language-kotlin">val config = FlagsConfig(
    // ...
    analytics = object : AnalyticsAdapter {
        override fun trackEvent(event: AnalyticsEvent) {
            when (event) {
                is AnalyticsEvent.ExperimentExposure -&gt; {
                    // Send to Firebase Analytics, Amplitude, etc.
                    firebaseAnalytics.logEvent(&quot;experiment_exposure&quot;) {
                        param(&quot;experiment_key&quot;, event.experimentKey)
                        param(&quot;variant&quot;, event.variant)
                    }
                }
            }
        }
    }
)
</code></pre>

<hr />

<h2>üéØ Targeting Rules</h2>

<h3>Region-based Targeting</h3>

<pre><code class="language-kotlin">// Server returns experiment with targeting:
// &quot;targeting&quot;: {
//   &quot;type&quot;: &quot;region_in&quot;,
//   &quot;regions&quot;: [&quot;US&quot;, &quot;CA&quot;, &quot;GB&quot;]
// }

val assignment = manager.assign(
    &quot;premium_feature_test&quot;,
    ctx = EvalContext(
        userId = &quot;user_123&quot;,
        attributes = mapOf(&quot;region&quot; to &quot;US&quot;) // User from US
    )
)
// assignment != null ‚úÖ (if user is from US, CA or GB)
</code></pre>

<h3>App Version Targeting</h3>

<pre><code class="language-kotlin">// &quot;targeting&quot;: {
//   &quot;type&quot;: &quot;app_version_gte&quot;,
//   &quot;version&quot;: &quot;2.5.0&quot;
// }

val assignment = manager.assign(
    &quot;new_ui_rollout&quot;,
    ctx = EvalContext(
        userId = &quot;user_123&quot;,
        attributes = mapOf(&quot;app_version&quot; to &quot;2.6.1&quot;)
    )
)
// assignment != null ‚úÖ (2.6.1 &gt;= 2.5.0)
</code></pre>

<p>Supports <strong>Semantic Versioning</strong> (SemVer):</p>
<ul>
<li><code>1.0.0</code> > <code>1.0.0-beta</code></li>
<li><code>2.1.0</code> > <code>2.0.9</code></li>
<li><code>1.0.0-rc.2</code> > <code>1.0.0-beta.1</code></li>
</ul>

<h3>Custom Attributes</h3>

<pre><code class="language-kotlin">// &quot;targeting&quot;: {
//   &quot;type&quot;: &quot;attribute_equals&quot;,
//   &quot;key&quot;: &quot;subscription_tier&quot;,
//   &quot;value&quot;: &quot;premium&quot;
// }

val assignment = manager.assign(
    &quot;premium_only_feature&quot;,
    ctx = EvalContext(
        userId = &quot;user_123&quot;,
        attributes = mapOf(
            &quot;subscription_tier&quot; to &quot;premium&quot;,
            &quot;account_age_days&quot; to 365
        )
    )
)
// assignment != null ‚úÖ (if subscription_tier == &quot;premium&quot;)
</code></pre>

<h3>Composite Rules (AND/OR)</h3>

<pre><code class="language-kotlin">// &quot;targeting&quot;: {
//   &quot;type&quot;: &quot;composite&quot;,
//   &quot;operator&quot;: &quot;AND&quot;,
//   &quot;rules&quot;: [
//     { &quot;type&quot;: &quot;region_in&quot;, &quot;regions&quot;: [&quot;US&quot;] },
//     { &quot;type&quot;: &quot;app_version_gte&quot;, &quot;version&quot;: &quot;3.0.0&quot; }
//   ]
// }

// User must be from US AND have version &gt;= 3.0.0
</code></pre>

<hr />

<h2>üîå Providers</h2>

<h3>Firebase Remote Config</h3>

<pre><code class="language-kotlin">// build.gradle.kts
implementation(project(&quot;:flagship-provider-firebase&quot;))

// Recommended: Using factory (Android)
import io.maxluxs.flagship.provider.firebase.FirebaseProviderFactory

val provider = FirebaseProviderFactory.create(
    application = application,
    defaults = mapOf(
        &quot;new_feature&quot; to false,
        &quot;dark_mode&quot; to false
    ),
    name = &quot;firebase&quot;
)

val config = FlagsConfig(
    appKey = &quot;my-app&quot;,
    environment = &quot;production&quot;,
    providers = listOf(provider),
    cache = PersistentCache(FlagsSerializer())
)
</code></pre>

<p><strong>Alternative: Manual Setup</strong></p>

<pre><code class="language-kotlin">// For advanced use cases or iOS
val adapter = AndroidFirebaseAdapter(Firebase.remoteConfig)
val provider = FirebaseRemoteConfigProvider(adapter, name = &quot;firebase&quot;)
</code></pre>

<p><strong>Firebase Console structure:</strong></p>
<pre><code class="language-json">{
  &quot;flagship_flags&quot;: {
    &quot;new_payment_flow&quot;: true,
    &quot;dark_mode_enabled&quot;: false
  },
  &quot;flagship_experiments&quot;: {
    &quot;checkout_test&quot;: {
      &quot;variants&quot;: [
        { &quot;name&quot;: &quot;control&quot;, &quot;weight&quot;: 0.5 },
        { &quot;name&quot;: &quot;variant_a&quot;, &quot;weight&quot;: 0.5 }
      ]
    }
  }
}
</code></pre>

<h3>REST Provider</h3>

<pre><code class="language-kotlin">// build.gradle.kts
implementation(project(&quot;:flagship-provider-rest&quot;))

// Code
val httpClient = HttpClient(CIO) {
    install(ContentNegotiation) {
        json()
    }
}

val provider = RestFlagsProvider(
    httpClient = httpClient,
    baseUrl = &quot;https://api.example.com/flags&quot;
)
</code></pre>

<p><strong>REST API format:</strong></p>
<pre><code class="language-json">{
  &quot;revision&quot;: &quot;abc123&quot;,
  &quot;fetchedAt&quot;: 1699999999999,
  &quot;ttlMs&quot;: 900000,
  &quot;flags&quot;: {
    &quot;new_payment_flow&quot;: { &quot;type&quot;: &quot;bool&quot;, &quot;value&quot;: true },
    &quot;api_timeout&quot;: { &quot;type&quot;: &quot;int&quot;, &quot;value&quot;: 5000 }
  },
  &quot;experiments&quot;: {
    &quot;checkout_test&quot;: {
      &quot;variants&quot;: [
        { &quot;name&quot;: &quot;control&quot;, &quot;weight&quot;: 0.5 },
        { &quot;name&quot;: &quot;treatment&quot;, &quot;weight&quot;: 0.5 }
      ],
      &quot;targeting&quot;: {
        &quot;type&quot;: &quot;region_in&quot;,
        &quot;regions&quot;: [&quot;US&quot;, &quot;CA&quot;]
      }
    }
  }
}
</code></pre>

<h3>Custom Provider</h3>

<pre><code class="language-kotlin">class MyCustomProvider : FlagsProvider {
    override val name: String = &quot;MyBackend&quot;
    
    override suspend fun fetch(context: EvalContext): ProviderSnapshot {
        // Load data from your backend
        val response = myApi.getFlags()
        
        return ProviderSnapshot(
            revision = response.version,
            fetchedAt = Clock.System.now().toEpochMilliseconds(),
            ttlMs = 3600_000, // 1 hour
            flags = mapOf(
                &quot;feature_x&quot; to FlagValue.Bool(response.featureXEnabled)
            ),
            experiments = emptyMap()
        )
    }
}
</code></pre>

<hr />

<h2>üíæ Caching & Offline Mode</h2>

<h3>In-Memory Cache (default)</h3>

<pre><code class="language-kotlin">val config = FlagsConfig(
    // ...
    cache = InMemoryCache() // Fast but not persistent
)
</code></pre>

<p><strong>Pros:</strong> Very fast</p>
<p><strong>Cons:</strong> Data lost on app restart</p>

<h3>Persistent Cache</h3>

<pre><code class="language-kotlin">val config = FlagsConfig(
    // ...
    cache = PersistentCache(FlagsSerializer())
)
</code></pre>

<p><strong>Android:</strong> Uses <code>SharedPreferences</code></p>
<p><strong>iOS:</strong> Uses <code>NSUserDefaults</code></p>

<p><strong>Pros:</strong> Works offline, persists between launches</p>
<p><strong>Cons:</strong> Slightly slower</p>

<h3>TTL (Time-To-Live)</h3>

<p>Each snapshot has a TTL. After expiration, Flagship will attempt to refresh:</p>

<pre><code class="language-kotlin">// In provider
ProviderSnapshot(
    revision = &quot;v123&quot;,
    fetchedAt = Clock.System.now().toEpochMilliseconds(),
    ttlMs = 1800_000, // 30 minutes
    flags = myFlags,
    experiments = myExperiments
)
</code></pre>

<h3>Offline-first Architecture</h3>

<pre><code class="language-kotlin">// 1. Flagship tries to load data from providers
manager.bootstrap()

// 2. If network unavailable, uses cache
// 3. If no cache, uses default values
val enabled = manager.isEnabled(&quot;feature&quot;, default = false)
</code></pre>

<hr />

<h2>üõ†Ô∏è Debug Dashboard</h2>

<h3>Enable in Android</h3>

<pre><code class="language-kotlin">// In debug build
@Composable
fun DebugMenu() {
    val manager = Flags.manager()
    
    FlagsDashboard(
        manager = manager,
        allowOverrides = true,   // Allow overrides
        allowEnvSwitch = false,  // Disable environment switching
        useDarkTheme = false
    )
}
</code></pre>

<h3>Dashboard Features</h3>

<p>1. <strong>All Flags List</strong> - current values and types</p>
<p>2. <strong>Overrides</strong> - force enable/disable flags</p>
<p>3. <strong>Experiment Assignments</strong> - view assigned variants</p>
<p>4. <strong>Provider Status</strong> - loading status from each provider</p>
<p>5. <strong>Cache Info</strong> - when data was loaded, TTL</p>

<h3>Local Overrides</h3>

<pre><code class="language-kotlin">// Programmatically
manager.setOverride(&quot;new_feature&quot;, FlagValue.Bool(true))

// Check
manager.isEnabled(&quot;new_feature&quot;) // true (override)

// Remove override
manager.clearOverride(&quot;new_feature&quot;)

// Remove all overrides
manager.listOverrides().forEach { manager.clearOverride(it) }
</code></pre>

<p><strong>‚ö†Ô∏è Important:</strong> Overrides are local only and don't affect other users!</p>

<hr />

<h2>üìä Analytics Integration</h2>

<h3>Firebase Analytics</h3>

<pre><code class="language-kotlin">val config = FlagsConfig(
    // ...
    analytics = object : AnalyticsAdapter {
        override fun trackEvent(event: AnalyticsEvent) {
            when (event) {
                is AnalyticsEvent.ExperimentExposure -&gt; {
                    Firebase.analytics.logEvent(&quot;experiment_exposure&quot;) {
                        param(&quot;experiment_key&quot;, event.experimentKey)
                        param(&quot;variant&quot;, event.variant)
                        param(&quot;timestamp&quot;, event.timestamp)
                    }
                }
            }
        }
    }
)
</code></pre>

<h3>Amplitude</h3>

<pre><code class="language-kotlin">analytics = object : AnalyticsAdapter {
    override fun trackEvent(event: AnalyticsEvent) {
        when (event) {
            is AnalyticsEvent.ExperimentExposure -&gt; {
                Amplitude.getInstance().logEvent(
                    &quot;Experiment Exposure&quot;,
                    JSONObject().apply {
                        put(&quot;experiment_key&quot;, event.experimentKey)
                        put(&quot;variant&quot;, event.variant)
                    }
                )
            }
        }
    }
}
</code></pre>

<h3>Mixpanel</h3>

<pre><code class="language-kotlin">analytics = object : AnalyticsAdapter {
    override fun trackEvent(event: AnalyticsEvent) {
        when (event) {
            is AnalyticsEvent.ExperimentExposure -&gt; {
                mixpanel.track(
                    &quot;Experiment Exposure&quot;,
                    mapOf(
                        &quot;experiment_key&quot; to event.experimentKey,
                        &quot;variant&quot; to event.variant
                    )
                )
            }
        }
    }
}
</code></pre>

<hr />

<h2>‚úÖ Best Practices</h2>

<h3>1. Use Meaningful Flag Names</h3>

<pre><code class="language-kotlin">// ‚úÖ Good
&quot;new_payment_flow&quot;
&quot;dark_mode_enabled&quot;
&quot;premium_features_unlock&quot;

// ‚ùå Bad
&quot;flag1&quot;
&quot;test&quot;
&quot;temp_feature&quot;
</code></pre>

<h3>2. Remove Old Flags</h3>

<pre><code class="language-kotlin">// After full rollout, remove the flag and simplify code:

// Before
if (manager.isEnabled(&quot;new_checkout&quot;)) {
    NewCheckout()
} else {
    OldCheckout()
}

// After (when new_checkout = 100%)
NewCheckout()
</code></pre>

<h3>3. Always Provide Defaults</h3>

<pre><code class="language-kotlin">// ‚úÖ Always provide defaults
val timeout = manager.value(&quot;request_timeout&quot;, default = 5000)

// ‚ùå Avoid nulls
val timeout = manager.value&lt;Int?&gt;(&quot;request_timeout&quot;, default = null) // Dangerous!
</code></pre>

<h3>4. Cache Manager Instance</h3>

<pre><code class="language-kotlin">// ‚úÖ Good
class MyRepository {
    private val flags = Flags.manager() // Once
    
    suspend fun isFeatureEnabled() = flags.isEnabled(&quot;feature_x&quot;)
}

// ‚ùå Bad
suspend fun checkFeature() {
    val flags = Flags.manager() // Creates new instance each time
    return flags.isEnabled(&quot;feature_x&quot;)
}
</code></pre>

<h3>5. Test with Overrides</h3>

<pre><code class="language-kotlin">@Test
fun testNewPaymentFlow() {
    val manager = Flags.manager()
    
    // Force enable flag
    manager.setOverride(&quot;new_payment_flow&quot;, FlagValue.Bool(true))
    
    // Test
    assertTrue(manager.isEnabled(&quot;new_payment_flow&quot;))
    
    // Cleanup
    manager.clearOverride(&quot;new_payment_flow&quot;)
}
</code></pre>

<h3>6. Handle Errors</h3>

<pre><code class="language-kotlin">lifecycleScope.launch {
    try {
        val manager = Flags.manager()
        val success = manager.ensureBootstrap(5000)
        
        if (!success) {
            // Show warning or use fallback
            showOfflineMode()
        }
    } catch (e: Exception) {
        Log.e(&quot;Flags&quot;, &quot;Failed to initialize&quot;, e)
        // Graceful degradation
    }
}
</code></pre>

<hr />

<h2>‚ùì FAQ</h2>

<h3>Q: How does provider priority work?</h3>

<p><strong>A:</strong> Providers are processed in order in the list. The first successful result is used.</p>

<pre><code class="language-kotlin">providers = listOf(
    FirebaseProvider(),  // Priority 1
    RestProvider(),      // Fallback 1
    LocalProvider()      // Fallback 2
)
</code></pre>

<h3>Q: What happens when offline?</h3>

<p><strong>A:</strong> Flagship uses the last cached snapshot. If no cache, uses default values.</p>

<h3>Q: Can I use Flagship without internet?</h3>

<p><strong>A:</strong> Yes! Use <code>PersistentCache()</code> and preload data once. Then the app works offline.</p>

<h3>Q: How often are flags updated?</h3>

<p><strong>A:</strong> Depends on TTL in snapshot (default 15 minutes). You can force refresh:</p>

<pre><code class="language-kotlin">manager.refresh()
</code></pre>

<h3>Q: Is Hot Reload supported?</h3>

<p><strong>A:</strong> Yes! Use <code>FlagsListener</code> for reactive updates:</p>

<pre><code class="language-kotlin">manager.addListener(object : FlagsListener {
    override fun onSnapshotUpdated(providersCount: Int) {
        // Update UI
    }
})
</code></pre>

<h3>Q: How to test experiments?</h3>

<p><strong>A:</strong> Use debug dashboard to override variants or use <code>setOverride()</code>.</p>

<h3>Q: Is local storage safe?</h3>

<p><strong>A:</strong> Yes. Flagship doesn't store sensitive data (tokens, keys). Only public flag settings.</p>

<h3>Q: Can I use Flagship in Compose Desktop/Web?</h3>

<p><strong>A:</strong> Currently only Android and iOS are supported. Desktop/Web may be added in the future.</p>

<hr />

<p><p align="center"></p>
<p><b>Need help? Create an Issue on <a href="https://github.com/maxluxs/Flagship/issues">GitHub</a>!</b></p>
<p></p></p>


    </div>
    <footer>
        <p>Made with ‚ù§Ô∏è by <a href="https://github.com/maxluxs" target="_blank">@maxluxs</a> ‚Ä¢ Licensed under MIT</p>
    </footer>
</body>
</html>